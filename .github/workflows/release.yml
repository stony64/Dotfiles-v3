# ... (Trigger und Test-Job bleiben gleich)

release:
    name: Create GitHub Release
    needs: test
    runs-on: ubuntu-latest
    permissions:
        contents: write

    steps:
        - name: ðŸ“¥ Checkout Repository
          uses: actions/checkout@v4
          with:
              fetch-depth: 0

        - name: ðŸ· Extract Version from Code
          id: meta
          shell: bash
          run: |
              # Sucht nach DF_PROJECT_VERSION="X.Y.Z" in core.sh
              # Nutzt sed, um nur den Wert zwischen den AnfÃ¼hrungszeichen zu isolieren
              RAW_VER=$(grep 'DF_PROJECT_VERSION=' core.sh | sed -e 's/.*="//' -e 's/".*//')

              # Fallback, falls grep fehlschlÃ¤gt
              VERSION=${RAW_VER:-${{ github.ref_name }}}
              echo "DF_VER=$VERSION" >> $GITHUB_OUTPUT
              echo "Extrahiert: $VERSION"

        - name: ðŸš€ Publish GitHub Release
          uses: softprops/action-gh-release@v2
          with:
              tag_name: ${{ github.ref_name }}
              # Nutzt die dynamische Version im Titel
              name: "Dotfiles Framework v${{ steps.meta.outputs.DF_VER }}"
              body: |
                  ## ðŸ›  Dotfiles Framework v${{ steps.meta.outputs.DF_VER }} (Stable)

                  Automatisiertes Release basierend auf dem Git-Tag: **${{ github.ref_name }}**.
                  Interner Framework-Status: **v${{ steps.meta.outputs.DF_VER }}**.

                  ### ðŸ“‹ Release Checkliste (CI):
                  - âœ… **ShellCheck:** Bestanden (Style-Guide v1.4.2).
                  - âœ… **Versions-Match:** Code und Release-Tag synchronisiert.

                  ### ðŸ“¦ Installation:
                  ```bash
                  sudo git clone ${{ github.server_url }}/${{ github.repository }} /opt/dotfiles
                  sudo /opt/dotfiles/dotfilesctl.sh install "$USER"
                  ```

                  ---
                  *Dieses Release wurde dynamisch generiert.*
              generate_release_notes: true
